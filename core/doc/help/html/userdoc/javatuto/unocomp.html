<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/xhtml1-strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
        <title>UNO Java component creation explained</title>
        <meta name="generator" content="Bluefish 1.0.5"/>
        <meta name="description" content="OpenOffice.org allows the user to create new components to 
      fit its needs. However understanding OpenOffice.org component 
      model - UNO - is difficult for a beginner. This tutorial aims to 
      guide the new developper steps throught UNO development using an 
      Eclipse plugin." />
        <link href="../../styles.css" rel="stylesheet" type="text/css" />
    </head>
    
	 <body class="article">
    	<h3 class="title">UNO Components</h3>
      <p>This section will explain some very basic things about UNO 
      	components. You might skip it if you already know it. First I 
      	will explain what is a component and it's mains parts. 
    	  	Afterwards, I will explain what is needed to create a UNO 
    	  	component to help you to fully understand the different tools and 
     	 	their use during the tutorial.</p>
            
     	<h4 class="title">Components anatomy</h4>
                        
      	<p><span class="citation">"A component is a system element offering a 
        		predefined service and able to communicate with other 
        		components"</span> explains 
        		<a href="http://fr.wikipedia.org/wiki/composant" target="_top">
        		Wikipedia (Fr)</a>. In UNO case a component will generally be 
        		delivered as a package containing a library (share library in 
        		C++ or jar in Java). For UNO a component is made of two distinct
        		parts: specifications and an implementation.</p>
                
         <dl>
         	<dt>Specification</dt>
         	<dd><p>definition in a common language of what the 
            	component should do. For UNO, this language is called 
              	UNO-IDL and is more or less similar to 
              	<a href="http://en.wikipedia.org/wiki/Corba" target="_top">
          	   Corba</a> IDL. The documented part that will be 
            	provided as an API to use the component is the 
              	specification. Thus it should be complete and 
              	implementation independent.</p>
            </dd>
            <dt>Implementation</dt>
            <dd><p>is the code that will realize what is described in 
               the component specifications. This programming language 
               can either be C++, Java, Python or some others. This is 
               the internal part of the component and will not be 
               accessible from another component.</p>
            </dd>
        	</dl>
        	<p>In order UNO knows which implementation corresponds to 
        		which specification, the component will use registries. There 
        		are two of them: the first one describes all the component 
        		specifications (<code class="filename">types.rdb</code>) and the second 
        		translates the implementation into specifications ( <code class="filename">
        		services.rdb</code>) and is generated from the implementation.</p>
        		
        	<h4 class="title">Components creation process</h4>
        	
        		<p>To help you better understand what should be done to get 
        			a component from it's specification and sources, you 
		         should have a look at the illustration 1. As shown by the 
		         diagram, the specifications are compiled and merged into one 
		         types.rdb registry. Class files are generated from that file to 
		         translate the specifications into a Java class definition file 
		         which is build with the implementation into class using the 
		         java compiler. All the classes are delivered as a jar file with 
		         a specific manifest as we will see further in this tutorial. 
		         This doesn't make a usable OpenOffice.org: the <code class="filename">
		         types.rdb</code> and jar file will have to be zipped into a 
		         <code class="filename">.uno.pkg</code> file described with another 
		         manifest.</p>
		         
		         <div class="mediaobject" align="center">
		         	<img src="img/CompilationChain.png" align="middle" 
		         		  alt="Java UNO compilation chain" />
		            <div class="caption">Illustration 1: Java Uno compilation chain</div>
		         </div>
		         
		         <p>As I will explain it later, the Eclipse plugin will hide 
		         	some of these operations, however you will need to know how 
		         	they work to fully understand the build process and what we 
		         	will do in the next steps.</p>
	 </body>        
</html>