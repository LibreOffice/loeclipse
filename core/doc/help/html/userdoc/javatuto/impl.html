<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/xhtml1-strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
        <title>UNO Java component creation explained</title>
        <meta name="generator" content="Bluefish 1.0.5"/>
        <meta name="description" content="OpenOffice.org allows the user to create new components to 
      fit its needs. However understanding OpenOffice.org component 
      model - UNO - is difficult for a beginner. This tutorial aims to 
      guide the new developper steps throught UNO development using an 
      Eclipse plugin." />
        <link href="../../styles.css" rel="stylesheet" type="text/css" />
    </head>
    
	 <body class="article">
    	
    	<h3 class="title">Writing the implementation</h3>
    	
    	<p>You now have complete specifications for your component, 
	      but there is still the implementation to do. For the moment, the 
      	plugin doesn't assist you enough and you will have to 
      	copy-paste some code that could be automatically generated in 
      	next version. The tutorial will now assume that you know how to 
      	handle Java code in Eclipse, otherwise it would be too long to 
      	read.</p>
      	
     	<h4 class="title">Implementing the code</h4>
     	
     	<p>To implement the code, you will create a new Java class 
        	named <code class="code">HelloworldImpl</code> in the implementation 
        	package, that is: <code class="code">org.openoffice.helloworld.comp</code>. 
        	This class will extend 
         <code class="code">com.sun.star.lib.uno.helper.WeakBase</code> and implement 
         <code class="code">XHelloworld</code>. This is a quite difficult part to 
         understand: the UNO-IDL interface is translated into a Java 
         interface and we implement the interfaces. The mapping between 
         the UNO-IDL service and its implementation will be done in the 
         next chapter of this tutorial.</p>
         
      <p>The <code class="code">WeakBase</code> class which is extended is a 
         helper to implement some other basic interfaces. In our 
         tutorial, we will need it only to implement the 
         <code class="code">com.sun.star.lang.XTypeProvider</code> interface used by 
         OpenOffice.org basic to get an access to the component's 
         methods and attributes.</p>
         
      <p>If you checked the <span class="guilabel">Inherit abstract 
         methods</span> box in the class wizard, you can note that 
         the <code class="code">XHelloworld</code> method <code class="code">sayHello()</code> is 
         added to the generated code. The implementation will just 
         consist in filling the empty body of this method. Thus you can 
         change the code to the following:</p>
         
      <pre class="programlisting">public String sayHello() {
 return "Hello UNO world from Java";
}</pre>

		<p>Of course, serious components will have more complex 
         specifications and implementations, but it is a beginning: just 
         a simple standard Hello world.</p>
         
      <h4 class="title">The registration class</h4>
      
      <p>Now that our interface is implemented, we will need to 
         make the link between the service and its implementation. This 
         would perhaps be performed automatically in future versions of 
         the plugin, but we still have to do it now. You will just have 
         to copy the following code in your HelloworldImpl class. I will 
         not explain this code here, because it should be created 
         automatically and is only a rearranged copy-paste from the 
         OpenOffice.org Developer's Guide. If you are interested in 
         this topic, please report to the "Going further" section of 
         this tutorial. You just have to remember that the class 
         containing this code is named "Registration class" because you 
         will need to give its name to package the component.</p>
         
      <pre class="programlisting">/** is used by the registration methods to return the implemented 
 *  service name.
 */
final static String __serviceName =
     "org.openoffice.helloworld.Helloworld";
 
public static XSingleServiceFactory __getServiceFactory( 
  String implName, 
  XMultiServiceFactory multiFactory, 
  XRegistryKey regKey){
  
 XSingleServiceFactory xSingleServiceFactory = null;

 if (implName.equals(HelloworldImpl.class.getName())) {
  xSingleServiceFactory = FactoryHelper.getServiceFactory(
   HelloworldImpl.class, __serviceName, 
   multiFactory, regKey);
 }
  
 return xSingleServiceFactory;
}
   
public static boolean __writeRegistryServiceInfo(
  XRegistryKey regKey) {
  
 boolean b = FactoryHelper.writeRegistryServiceInfo(
   HelloworldImpl.class.getName(), 
   __serviceName, regKey);
  
 return b;
}</pre>

	 </body>        
</html>